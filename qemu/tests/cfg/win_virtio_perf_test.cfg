- win_virtio_perf_test:
    only q35
    only ovmf
    only Win2022, Win2025
    type = win_virtio_perf_test
    login_timeout = 720
    start_vm = no
    auto_cpu_model = yes
    clone_master = yes
    master_images_clone = image1
    remove_image_image1 = yes
    # support nested virtualization
    HostCpuVendor.intel:
        cpu_model_flags += ',vmx=on'
    HostCpuVendor.amd:
        cpu_model_flags += ',svm=on'
    restore_ovmf_vars = yes
    check_secure_boot_enabled_cmd = 'powershell -command "Confirm-SecureBootUEFI"'
    dst_path = "C:\dgreadiness"
    dgreadiness_path_cmd = "cd ${dst_path}\dgreadiness"
    set_ps_policy_cmd = 'powershell -command "Set-ExecutionPolicy -ExecutionPolicy Unrestricted -Force"'
    vbs_enable_cmd = 'powershell -command ".\DG_Readiness_Tool_v3.6.ps1 -Enable"'
    vbs_disable_cmd = 'powershell -command ".\DG_Readiness_Tool_v3.6.ps1 -Disable"'
    vbs_ready_cmd = 'powershell -command ".\DG_Readiness_Tool_v3.6.ps1 -Ready"'
    vbs_enable_info = 'Enabling Hyper-V and IOMMU successful'
    vbs_disable_info = 'Disabling Hyper-V and IOMMU successful'
    vbs_ready_info = 'HVCI, Credential-Guard, and Config-CI are enabled and running'
    dg_command = 'powershell -command "Get-CimInstance -ClassName Win32_DeviceGuard'
    dg_command += ' -Namespace root/Microsoft/Windows/DeviceGuard"'
    # WSL2 commands
    wsl_enable_cmd = 'dism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart'
    vm_platform_cmd = 'dism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart'
    wsl_set_default_cmd = 'wsl --set-default-version 2'
    rhel_install_cmd = 'wsl --install -d RHEL'
    wsl_list_cmd = 'wsl --list --verbose'
    rhel_distro_name = 'RHEL'
    rhel_test_cmd = 'wsl -d RHEL -- uname -a'
    # iommu setting, currently qemu only compatible with intel model
    variants:
        - no_iommu:
        - iommu_enable:
            only HostCpuVendor.intel
            machine_type_extra_params = "kernel-irqchip=split"
            # iommu device
            intel_iommu = yes
            iommu_device_iotlb = on
            iommu_eim = off
            iommu_intremap = on
            iommu_aw_bits = 48
            # virtio device
            virtio_dev_iommu_platform = on
            virtio_dev_filter = '^(?:(?:virtio-)|(?:vhost-))(?!(?:user)|(?:iommu))'
            # ats=on parily used with device-iotlb=on
            virtio_dev_ats = on
            enable_guest_iommu = yes
