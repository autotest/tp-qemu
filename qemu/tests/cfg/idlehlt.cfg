- idlehlt:
    type = idlehlt
    only Linux
    only HostCpuVendor.amd
    kill_vm = yes
    login_timeout = 240
    start_vm = no
    image_snapshot = yes
    mem = 8192
    smp = 8
    virtio_dev_iommu_platform = on
    virtio_dev_disable_legacy = on
    trace_dir = "/sys/kernel/tracing"
    hlt_exit_reason = "0x0a6"
    url_cpuid_tool = "http://www.etallen.com/cpuid/cpuid-20250513.src.tar.gz"
    bios_path = /usr/share/ovmf/OVMF.fd
    module_status = Y y 1
    variants:
        - svm:
        - cvm:
            vm_sev_reduced_phys_bits = 1
            module_name = kvm_amd
            variants:
                - sev:
                    vm_secure_guest_type = sev
                    required_qemu = [2.12, )
                    param_name = sev
                    sev_guest_check = "journalctl | grep -i -w sev"
                    vm_sev_policy = 3
                - seves:
                    vm_secure_guest_type = sev
                    required_qemu = [6.0, )
                    param_name = sev_es
                    sev_guest_check = "journalctl | grep -i -w sev-es"
                    vm_sev_policy = 7
                - snp:
                    vm_secure_guest_type = snp
                    required_qemu = [9.1.0, )
                    param_name = sev_snp
                    snp_guest_check = "journalctl | grep -i -w snp"
                    vm_sev_policy = 196608
                    vm_mem_backend = memory-backend-memfd
