- sev_direct_kernel_boot:
    type = sev_direct_kernel_boot
    only Linux
    kill_vm = yes
    login_timeout = 240
    start_vm = no
    mem = 2048
    smp = 8
    vm_sev_reduced_phys_bits = 1
    vm_sev_cbitpos = 51
    virtio_dev_disable_legacy = on
    module_status = Y y 1
    guest_tool_install = "dnf install -y snpguest"
    attestation_script = regular_attestation_workflow.sh
    guest_dir = /home
    guest_cmd = ${guest_dir}/${attestation_script}
    host_script = sev-snp/${attestation_script}
    vm_sev_kernel_hashes = on
    kernel_params = "root=/dev/mapper/rhel-root ro console=tty0 rd.lvm.lv=rhel/root rd.lvm.lv=rhel/swap net.ifnames=0 console=ttyS0,115200"
    variants:
        - snp:
            bios_path =  /usr/share/edk2/ovmf/OVMF.amdsev.fd
            vm_secure_guest_type = snp
            snp_module_path = "/sys/module/kvm_amd/parameters/sev_snp"
            snp_guest_check = "journalctl|grep -i -w snp"
        - sev:
            vm_secure_guest_type = sev
            sev_module_path = "/sys/module/kvm_amd/parameters/sev_es"
            sev_guest_check = "journalctl|grep -i -w sev"
