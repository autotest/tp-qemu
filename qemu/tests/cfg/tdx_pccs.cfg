- tdx_pccs:
    type = tdx_pccs
    only Linux
    only x86_64
    only HostCpuVendor.intel
    kill_vm = yes
    login_timeout = 240
    start_vm = no
    image_snapshot = yes
    vm_secure_guest_type = tdx
    vm_secure_guest_object_options = quote-generation-socket.type=unix quote-generation-socket.path=/run/tdx-qgs/qgs.socket
    machine_type_extra_params = "kernel-irqchip=split"
    bios_path = /usr/share/edk2/ovmf/OVMF.inteltdx.secboot.fd
    tdx_module_path = "/sys/module/kvm_intel/parameters/tdx"
    module_status = Y y 1
    tdx_guest_check = "journalctl|grep -i -w tdx"
    attestation_script = attestation.sh
    guest_dir = /home
    guest_cmd = "${guest_dir}/${attestation_script} ${guest_script}"
    host_script = tdx/${attestation_script}
    dcap_preset_services = "qgs mpa_registration"
    dcap_non_preset_services = "pccs"
    pccs_config_dir = /etc/pccs/
    # PCCS tokens
    pccs_user_token = redhat
    pccs_admin_token = kvmautotest
    # PCCS SSL configuration
    pccs_ssl_dir = "/etc/pccs/ssl"
    pccs_ssl_cert = "/etc/pccs/ssl/server-cert.pem"
    pccs_ssl_key = "/etc/pccs/ssl/server-key.pem"
    generate_ssl_cmd = 'openssl req -x509 -nodes -days 365 -newkey rsa:2048  -keyout ${pccs_ssl_key}  -out ${pccs_ssl_cert}  -subj "/O=Intel/OU=TDX/CN=localhost"'
    ca_trust_cert = "/etc/pki/ca-trust/source/anchors/pccs-server.crt"
    # SGX QCNL configuration
    sgx_qcnl_config_file = /etc/sgx_default_qcnl.conf
    pccs_port = 8082
    set_pccs_port = "sed -i '/pccs_url/s/8081/${pccs_port}/' ${sgx_qcnl_config_file}"
    # pccsadmin tool test command
    pccsadmin_script = tdx/pccsadmin_test.sh ${pccs_admin_token} ${pccs_port}
    variants:
        - basic:
            smp = 1
            mem = 4096
