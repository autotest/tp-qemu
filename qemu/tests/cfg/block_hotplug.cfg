- block_hotplug: install setup image_copy unattended_install.cdrom
    no RHEL.3.9
    no ide
    virt_test_type = qemu libvirt
    type = block_hotplug
    bootindex_image1 = 0
    start_vm = no
    not_preprocess = yes
    images += " stg0"
    boot_drive = no
    get_disk_cmd = "ls /dev/[hsv]d[a-z]* | sort"
    disk_op_cmd = "dd if=%s of=/dev/null bs=1k count=1000 iflag=direct &&"
    disk_op_cmd += " dd if=/dev/zero of=%s bs=1k count=1000 oflag=direct"
    kill_vm_on_error = yes

    Windows:
        disk_index = "1 2"
        disk_letter = "I J"
        disk_op_cmd = "WIN_UTILS:\Iozone\iozone.exe -azR -r 64k -n 125M -g 512M -M -i 0"
        disk_op_cmd += " -i 1 -b %s:\iozone_test -f %s:\testfile"

    variants:
        - one_pci:
            repeat_times = 1
        - multi_pci:
            repeat_times = 1
            variants:
                - @default:
                    images += " stg1"
                    q35, arm64-pci:
                        pcie_extra_root_port = 2
                - with_max_num:
                    Windows:
                        disk_index = ''
                        disk_letter = ''
                    images += " stg1 stg2 stg3 stg4 stg5 stg6 stg7 stg8 stg9 stg10"
                    images += " stg11 stg12 stg13 stg14 stg15 stg16 stg17 stg18 stg19 stg20"
                    images += " stg21 stg22"
                    q35:
                        Linux:
                            images += " stg23 stg24 stg25"
                            pcie_extra_root_port = 26
                        Windows:
                            pcie_extra_root_port = 23

    variants:
        - @default:
        - with_repetition:
            repeat_times = 100
        - with_reboot:
            sub_type_after_plug = boot
            sub_type_after_unplug = boot
            reboot_method = shell
        - with_shutdown:
            variants:
                - after_plug:
                    only with_plug
                    sub_type_after_plug = shutdown
                - after_unplug:
                    sub_type_after_unplug = shutdown
            shutdown_method = shell
            check_image = yes
            repeat_times = 1
        - with_stop_continue:
            sub_type_after_plug = stop_continue
            sub_type_after_unplug = stop_continue
        - with_system_reset:
            sub_type_after_plug = boot
            sub_type_after_unplug = boot
            reboot_method = system_reset
        - with_block_resize:
            only with_plug
            only one_pci
            sub_type_after_plug = block_resize
            blk_extra_params_stg0 += ",serial=TARGET_DISK0"
            disk_change_ratio = "1.5 0.5"
            repeat_times = 1
            image_size_stg0 = 10G
            Linux:
                image_size_stg = ${image_size_stg0}
                format_disk = yes
            Windows:
                accept_ratio = 0.0005
                need_rescan = yes
                disk_letter = I
                disk_index = 1
            virtio_scsi:
                driver_name = vioscsi
            virtio_blk:
                driver_name = viostor
            fmt_qcow2:
                Host_RHEL.m6, Host_RHEL.m7.u0, Host_RHEL.m7.u1, Host_RHEL.m7.u2, Host_RHEL.m7.u3, Host_RHEL.m7.u4, Host_RHEL.m7.u5:
                    disk_change_ratio = 1.5

    variants:
        - with_plug:
            need_plug = yes
        - without_plug:
            repeat_times = 1
            boot_drive = yes
            need_plug = no

    variants:
        - fmt_qcow2:
            image_extra_params = ""
            img_format_type = qcow2
            image_format_stg0 = qcow2
            image_format_stg1 = qcow2
            variants:
                - @default:
                - max_size:
                    only fmt_qcow2.max_size.with_plug.default.one_pci
                    image_size_stg0 = 16T
                    check_disk_size = yes
        - fmt_raw:
            image_extra_params = ""
            img_format_type = raw
            image_format_stg0 = raw
            image_format_stg1 = raw
            variants:
                - @default:
                - max_size:
                    only fmt_raw.max_size.with_plug.default.one_pci
                    image_size_stg0 = 16T
                    check_disk_size = yes

    variants:
        - block_virtio:
            drive_format = virtio
            get_disk_pattern = "^/dev/vd[a-z]*$"
        - block_scsi:
            drive_format = scsi-hd
            get_disk_pattern = "^/dev/sd[a-z]*$"
            block_scsi..with_plug:
                set_drive_bus = yes
    variants:
        - @default:
        - data_plane:
            no Host_RHEL.m6
            only with_plug.with_system_reset.one_pci, block_scsi..with_plug.with_repetition.one_pci
            iothreads = iothread0
            block_virtio:
                blk_extra_params_stg0 = "iothread=${iothreads}"
            block_scsi:
                no Host_RHEL.m7.u0, Host_RHEL.m7.u1, Host_RHEL.m7.u2
                bus_extra_params_image1 = "iothread=${iothreads}"
                bus_extra_params_stg0 = "iothread=${iothreads}"
