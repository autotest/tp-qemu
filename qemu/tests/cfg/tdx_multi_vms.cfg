- tdx_multi_vms:
    type = tdx_multi_vms
    only Linux
    only x86_64
    only HostCpuVendor.intel
    kill_vm = yes
    login_timeout = 240
    start_vm = no
    image_snapshot = yes
    vm_secure_guest_type = tdx
    vm_secure_guest_object_options = attributes=10000000 quote-generation-socket.type=unix quote-generation-socket.path=/run/tdx-qgs/qgs.socket
    machine_type_extra_params = "kernel-irqchip=split"
    bios_path =  /usr/share/edk2/ovmf/OVMF.inteltdx.fd
    tdx_module_path = "/sys/module/kvm_intel/parameters/tdx"
    module_status = Y y 1
    tdx_guest_check = "journalctl|grep -i -w tdx"
    attestation_script = attestation.sh
    guest_dir = /home
    # workaround temporary guest_script passing by profile
    guest_cmd = "${guest_dir}/${attestation_script} ${guest_script}"
    host_script = tdx/${attestation_script}
    variants:
        - single_vcpu:
            vms += " vm2"
            smp_fixed = 1
            vcpu_maxcpus=${smp_fixed}
            vcpu_cores_fixed = 1
            vcpu_threads_fixed = 1
            vcpu_sockets_fixed = 1
            mem = 4096
        - four_vms:
            vms += " vm2 vm3 vm4"
            smp = 8
        - max_vms:
            max_vms_cmd = "grep tdx /sys/fs/cgroup/misc.capacity | awk '{print $2}'"
            max_vcpu_cmd = "nproc"
